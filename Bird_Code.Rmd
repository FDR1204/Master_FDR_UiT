---
title: "Master_UiT_Birds"
author: "Femke"
date: "21 9 2023"
output: github_document
---
load necessary packages
```{r}

library(ggplot2)
library(readxl)


```



This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
dfFuglerSOM1 <- read_excel("Bird_SOM1.xlsx", 
    col_types = c("text", "text", 
        "text", "text", "text", "text", "text", 
        "text"))
View(dfFuglerSOM1)

dfFuglerSOM1<-dfFuglerSOM1 %>% add_column(Site="SOM1")



dfFuglerSOM1<-dfFuglerSOM1 %>%  mutate(Bird = case_when(
    endsWith(preferredPopularName, "svartbak") ~"Gull",
    endsWith(preferredPopularName, "gråmåke") ~"Gull",
    endsWith(preferredPopularName, "polarmåke") ~"Gull",
    endsWith(preferredPopularName, "sildemåke") ~"Gull",
    endsWith(preferredPopularName, "krykkje") ~"Gull",
    endsWith(preferredPopularName, "fiskemåke")~"Gull",
    endsWith(preferredPopularName, "tyvjo")~"Gull",
    endsWith(preferredPopularName, "grønlandsmåke")~"Gull",
    endsWith(preferredPopularName, "hettemåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "ismåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "polarjo")~"Gull",
    endsWith(preferredPopularName, "fjelljo")~"Gull",
    
    endsWith(preferredPopularName, "fjæreplytt")~"Wader",
    endsWith(preferredPopularName, "tjeld")~"Wader",
    endsWith(preferredPopularName, "småspove")~"Wader",
    endsWith(preferredPopularName, "rødstilk")~"Wader",
    endsWith(preferredPopularName, "storspove")~"Wader",
    endsWith(preferredPopularName, "steinvender")~"Wader",
    endsWith(preferredPopularName, "sandlo")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "lappspove")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "sandløper")~"Wader",
    endsWith(preferredPopularName, "temmincksnipe")~"Wader",
    endsWith(preferredPopularName, "gluttsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "polarsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "dvergsnipe")~"Wader",
    endsWith(preferredPopularName, "svarthalespove")~"Wader",
    endsWith(preferredPopularName, "myrsnipe")~"Wader",
    endsWith(preferredPopularName, "skogsnipe")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",
    endsWith(preferredPopularName, "strandsnipe")~"Wader",
    endsWith(preferredPopularName, "tundralo")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",

    
    endsWith(preferredPopularName, "sjøorre") ~ "Duck",
    endsWith(preferredPopularName, "havelle") ~"Duck",
    endsWith(preferredPopularName, "svartand") ~"Duck",
    endsWith(preferredPopularName, "laksand") ~"Duck",
    endsWith(preferredPopularName, "siland")~"Duck",
    endsWith(preferredPopularName, "ærfugl") ~ "Duck",
    endsWith(preferredPopularName, "stokkand") ~ "Duck",
    endsWith(preferredPopularName, "gravand") ~ "Duck",
    endsWith(preferredPopularName, "brilleand") ~ "Duck",
    endsWith(preferredPopularName, "brunnakke") ~ "Duck",
    endsWith(preferredPopularName, "toppand") ~ "Duck",
    endsWith(preferredPopularName, "snadderand") ~ "Duck",
    endsWith(preferredPopularName, "stjertand") ~ "Duck",
    endsWith(preferredPopularName, "krikkand") ~ "Duck",
    endsWith(preferredPopularName, "knekkand") ~ "Duck",
    endsWith(preferredPopularName, "stellerand") ~ "Duck",

    
    endsWith(preferredPopularName, "snøspurv") ~ "Other",
    endsWith(preferredPopularName, "heipiplerke") ~ "Other",
    endsWith(preferredPopularName, "lomvi") ~ "Other",
    endsWith(preferredPopularName, "storskarv") ~ "Other",
    endsWith(preferredPopularName, "toppskarv") ~ "Other",
    endsWith(preferredPopularName, "fjellvåk") ~ "Other",
    endsWith(preferredPopularName, "gjøk") ~ "Other",
    endsWith(preferredPopularName, "havørn") ~ "Other",
    endsWith(preferredPopularName, "dvergfalk") ~ "Other",
    endsWith(preferredPopularName, "alke") ~ "Other",
    endsWith(preferredPopularName, "ravn") ~ "Other",
    endsWith(preferredPopularName, "lirype") ~ "Other",
    endsWith(preferredPopularName, "sidensvans") ~ "Other",
    endsWith(preferredPopularName, "lunde") ~ "Other",
    endsWith(preferredPopularName, "granmeis") ~ "Other",
    endsWith(preferredPopularName, "hvitkinngås") ~ "Other",
    endsWith(preferredPopularName, "tårnfalk") ~ "Other",
    endsWith(preferredPopularName, "gråhegre") ~ "Other",
    endsWith(preferredPopularName, "sivspurv") ~ "Other",
    endsWith(preferredPopularName, "kråke") ~ "Other",
    endsWith(preferredPopularName, "ringtrost") ~ "Other",
    endsWith(preferredPopularName, "teist") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "sandsvale") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "møller") ~ "Other",
    endsWith(preferredPopularName, "bergirisk") ~ "Other",
    endsWith(preferredPopularName, "rødnebbterne") ~ "Other",
    endsWith(preferredPopularName, "gjerdesmett") ~ "Other",
    endsWith(preferredPopularName, "alkekonge") ~ "Other",
    endsWith(preferredPopularName, "gråtrost") ~ "Other",
    endsWith(preferredPopularName, "stær") ~ "Other",
    endsWith(preferredPopularName, "havsvale") ~ "Other",
    endsWith(preferredPopularName, "jernspurv") ~ "Other",
    endsWith(preferredPopularName, "gråspurv") ~ "Other",
    endsWith(preferredPopularName, "sothøne") ~ "Other",
    endsWith(preferredPopularName, "gråspett") ~ "Other",
    endsWith(preferredPopularName, "bjørkefink") ~ "Other",
    endsWith(preferredPopularName, "steinskvett") ~ "Other",
    endsWith(preferredPopularName, "havsule") ~ "Other",
    endsWith(preferredPopularName, "gulspurv") ~ "Other",
    endsWith(preferredPopularName, "havhest") ~ "Other",
    endsWith(preferredPopularName, "gulnebblom") ~ "Other",
    endsWith(preferredPopularName, "vipe") ~ "Other",
    endsWith(preferredPopularName, "grågås") ~ "Other",
    endsWith(preferredPopularName, "jordugle") ~ "Other",
    endsWith(preferredPopularName, "smålom") ~ "Other",
    endsWith(preferredPopularName, "havlire") ~ "Other",
    endsWith(preferredPopularName, "kortnebbgås") ~ "Other",
    endsWith(preferredPopularName, "svarttrost") ~ "Other",
    endsWith(preferredPopularName, "hønsehauk") ~ "Other",
    endsWith(preferredPopularName, "løvsanger") ~ "Other",
    endsWith(preferredPopularName, "svartstrupe") ~ "Other",
    endsWith(preferredPopularName, "skjære") ~ "Other",
    endsWith(preferredPopularName, "stormsvale") ~ "Other",
    endsWith(preferredPopularName, "linerle") ~ "Other",
    endsWith(preferredPopularName, "grønnfink") ~ "Other",
    endsWith(preferredPopularName, "skjærpiplerke") ~ "Other",
    endsWith(preferredPopularName, "makrellterne") ~ "Other",
    endsWith(preferredPopularName, "tundragås") ~ "Other",
    endsWith(preferredPopularName, "orrfugl") ~ "Other",
    endsWith(preferredPopularName, "grålire") ~ "Other",
    endsWith(preferredPopularName, "låvesvale") ~ "Other",
    endsWith(preferredPopularName, "kjøttmeis") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "pilfink") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "sivsanger") ~ "Other",
    endsWith(preferredPopularName, "enkeltbekkasin") ~ "Other",
    endsWith(preferredPopularName, "rødvingetrost") ~ "Other",
    endsWith(preferredPopularName, "kongeørn") ~ "Other",
    endsWith(preferredPopularName, "myrsnipe") ~ "Other",
    endsWith(preferredPopularName, "gransanger") ~ "Other",
    endsWith(preferredPopularName, "rugde") ~ "Other",
    endsWith(preferredPopularName, "tundrasædgås") ~ "Other",
    endsWith(preferredPopularName, "fjellrype") ~ "Other",
    endsWith(preferredPopularName, "heilo") ~ "Other",
    endsWith(preferredPopularName, "kanadatrane") ~ "Other",
    endsWith(preferredPopularName, "blåstrupe") ~ "Other",
    endsWith(preferredPopularName, "sangsvane") ~ "Other",
    endsWith(preferredPopularName, "egretthegre") ~ "Other",
    endsWith(preferredPopularName, "fossekall") ~ "Other",
    endsWith(preferredPopularName, "svarthvit fluesnapper") ~ "Other",
    endsWith(preferredPopularName, "gulerle") ~ "Other",
    endsWith(preferredPopularName, "tyrkerdue") ~ "Other",
    endsWith(preferredPopularName, "taksvale") ~ "Other",
    endsWith(preferredPopularName, "polarsisik") ~ "Other",
    endsWith(preferredPopularName, "tretåspett") ~ "Other",
    endsWith(preferredPopularName, "lappspurv") ~ "Other",
    endsWith(preferredPopularName, "bokfink") ~ "Other",
    endsWith(preferredPopularName, "dompap") ~ "Other",
    endsWith(preferredPopularName, "myrhauk") ~ "Other",
    endsWith(preferredPopularName, "rødstrupe") ~ "Other",
    endsWith(preferredPopularName, "ringdue") ~ "Other",
    endsWith(preferredPopularName, "storlom") ~ "Other",
    endsWith(preferredPopularName, "måltrost") ~ "Other",
    endsWith(preferredPopularName, "jaktfalk") ~ "Other",
    endsWith(preferredPopularName, "bydue") ~ "Other",
    endsWith(preferredPopularName, "munk") ~ "Other",
    endsWith(preferredPopularName, "duetrost") ~ "Other",
    endsWith(preferredPopularName, "spurvehauk") ~ "Other",
    endsWith(preferredPopularName, "taigasædgås") ~ "Other",
    endsWith(preferredPopularName, "dverggås") ~ "Other",
    endsWith(preferredPopularName, "kaie") ~ "Other",
     endsWith(preferredPopularName, "trepiplerke") ~ "Other",
     endsWith(preferredPopularName, "buskskvett") ~ "Other",
     endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    endsWith(preferredPopularName, "islom") ~ "Other",
    endsWith(preferredPopularName, "grønnsisik") ~ "Other"))
    
View(dfFuglerSOM1)

table(dfFuglerSOM1$Bird)

```
```{r pressure, echo=FALSE}
dfFuglerSOM2 <- read_excel("Bird_SOM2.xlsx", 
    col_types = c("text", "text", 
        "text", "text", "text", "text", "text", 
        "text"))
View(dfFuglerSOM2)
dfFuglerSOM2<-dfFuglerSOM2 %>% add_column(Site="SOM2")



dfFuglerSOM2<-dfFuglerSOM2 %>%  mutate(Bird = case_when(
        endsWith(preferredPopularName, "svartbak") ~"Gull",
    endsWith(preferredPopularName, "gråmåke") ~"Gull",
    endsWith(preferredPopularName, "polarmåke") ~"Gull",
    endsWith(preferredPopularName, "sildemåke") ~"Gull",
    endsWith(preferredPopularName, "krykkje") ~"Gull",
    endsWith(preferredPopularName, "fiskemåke")~"Gull",
    endsWith(preferredPopularName, "tyvjo")~"Gull",
    endsWith(preferredPopularName, "grønlandsmåke")~"Gull",
    endsWith(preferredPopularName, "hettemåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "ismåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "polarjo")~"Gull",
    endsWith(preferredPopularName, "fjelljo")~"Gull",
    
    endsWith(preferredPopularName, "fjæreplytt")~"Wader",
    endsWith(preferredPopularName, "tjeld")~"Wader",
    endsWith(preferredPopularName, "småspove")~"Wader",
    endsWith(preferredPopularName, "rødstilk")~"Wader",
    endsWith(preferredPopularName, "storspove")~"Wader",
    endsWith(preferredPopularName, "steinvender")~"Wader",
    endsWith(preferredPopularName, "sandlo")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "lappspove")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "sandløper")~"Wader",
    endsWith(preferredPopularName, "temmincksnipe")~"Wader",
    endsWith(preferredPopularName, "gluttsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "polarsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "dvergsnipe")~"Wader",
    endsWith(preferredPopularName, "svarthalespove")~"Wader",
    endsWith(preferredPopularName, "myrsnipe")~"Wader",
    endsWith(preferredPopularName, "skogsnipe")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",
    endsWith(preferredPopularName, "strandsnipe")~"Wader",
    endsWith(preferredPopularName, "tundralo")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",

    
    endsWith(preferredPopularName, "sjøorre") ~ "Duck",
    endsWith(preferredPopularName, "havelle") ~"Duck",
    endsWith(preferredPopularName, "svartand") ~"Duck",
    endsWith(preferredPopularName, "laksand") ~"Duck",
    endsWith(preferredPopularName, "siland")~"Duck",
    endsWith(preferredPopularName, "ærfugl") ~ "Duck",
    endsWith(preferredPopularName, "stokkand") ~ "Duck",
    endsWith(preferredPopularName, "gravand") ~ "Duck",
    endsWith(preferredPopularName, "brilleand") ~ "Duck",
    endsWith(preferredPopularName, "brunnakke") ~ "Duck",
    endsWith(preferredPopularName, "toppand") ~ "Duck",
    endsWith(preferredPopularName, "snadderand") ~ "Duck",
    endsWith(preferredPopularName, "stjertand") ~ "Duck",
    endsWith(preferredPopularName, "krikkand") ~ "Duck",
    endsWith(preferredPopularName, "knekkand") ~ "Duck",
    endsWith(preferredPopularName, "stellerand") ~ "Duck",

    
    endsWith(preferredPopularName, "snøspurv") ~ "Other",
    endsWith(preferredPopularName, "heipiplerke") ~ "Other",
    endsWith(preferredPopularName, "lomvi") ~ "Other",
    endsWith(preferredPopularName, "storskarv") ~ "Other",
    endsWith(preferredPopularName, "toppskarv") ~ "Other",
    endsWith(preferredPopularName, "fjellvåk") ~ "Other",
    endsWith(preferredPopularName, "gjøk") ~ "Other",
    endsWith(preferredPopularName, "havørn") ~ "Other",
    endsWith(preferredPopularName, "dvergfalk") ~ "Other",
    endsWith(preferredPopularName, "alke") ~ "Other",
    endsWith(preferredPopularName, "ravn") ~ "Other",
    endsWith(preferredPopularName, "lirype") ~ "Other",
    endsWith(preferredPopularName, "sidensvans") ~ "Other",
    endsWith(preferredPopularName, "lunde") ~ "Other",
    endsWith(preferredPopularName, "granmeis") ~ "Other",
    endsWith(preferredPopularName, "hvitkinngås") ~ "Other",
    endsWith(preferredPopularName, "tårnfalk") ~ "Other",
    endsWith(preferredPopularName, "gråhegre") ~ "Other",
    endsWith(preferredPopularName, "sivspurv") ~ "Other",
    endsWith(preferredPopularName, "kråke") ~ "Other",
    endsWith(preferredPopularName, "ringtrost") ~ "Other",
    endsWith(preferredPopularName, "teist") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "sandsvale") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "møller") ~ "Other",
    endsWith(preferredPopularName, "bergirisk") ~ "Other",
    endsWith(preferredPopularName, "rødnebbterne") ~ "Other",
    endsWith(preferredPopularName, "gjerdesmett") ~ "Other",
    endsWith(preferredPopularName, "alkekonge") ~ "Other",
    endsWith(preferredPopularName, "gråtrost") ~ "Other",
    endsWith(preferredPopularName, "stær") ~ "Other",
    endsWith(preferredPopularName, "havsvale") ~ "Other",
    endsWith(preferredPopularName, "jernspurv") ~ "Other",
    endsWith(preferredPopularName, "gråspurv") ~ "Other",
    endsWith(preferredPopularName, "sothøne") ~ "Other",
    endsWith(preferredPopularName, "gråspett") ~ "Other",
    endsWith(preferredPopularName, "bjørkefink") ~ "Other",
    endsWith(preferredPopularName, "steinskvett") ~ "Other",
    endsWith(preferredPopularName, "havsule") ~ "Other",
    endsWith(preferredPopularName, "gulspurv") ~ "Other",
    endsWith(preferredPopularName, "havhest") ~ "Other",
    endsWith(preferredPopularName, "gulnebblom") ~ "Other",
    endsWith(preferredPopularName, "vipe") ~ "Other",
    endsWith(preferredPopularName, "grågås") ~ "Other",
    endsWith(preferredPopularName, "jordugle") ~ "Other",
    endsWith(preferredPopularName, "smålom") ~ "Other",
    endsWith(preferredPopularName, "havlire") ~ "Other",
    endsWith(preferredPopularName, "kortnebbgås") ~ "Other",
    endsWith(preferredPopularName, "svarttrost") ~ "Other",
    endsWith(preferredPopularName, "hønsehauk") ~ "Other",
    endsWith(preferredPopularName, "løvsanger") ~ "Other",
    endsWith(preferredPopularName, "svartstrupe") ~ "Other",
    endsWith(preferredPopularName, "skjære") ~ "Other",
    endsWith(preferredPopularName, "stormsvale") ~ "Other",
    endsWith(preferredPopularName, "linerle") ~ "Other",
    endsWith(preferredPopularName, "grønnfink") ~ "Other",
    endsWith(preferredPopularName, "skjærpiplerke") ~ "Other",
    endsWith(preferredPopularName, "makrellterne") ~ "Other",
    endsWith(preferredPopularName, "tundragås") ~ "Other",
    endsWith(preferredPopularName, "orrfugl") ~ "Other",
    endsWith(preferredPopularName, "grålire") ~ "Other",
    endsWith(preferredPopularName, "låvesvale") ~ "Other",
    endsWith(preferredPopularName, "kjøttmeis") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "pilfink") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "sivsanger") ~ "Other",
    endsWith(preferredPopularName, "enkeltbekkasin") ~ "Other",
    endsWith(preferredPopularName, "rødvingetrost") ~ "Other",
    endsWith(preferredPopularName, "kongeørn") ~ "Other",
    endsWith(preferredPopularName, "myrsnipe") ~ "Other",
    endsWith(preferredPopularName, "gransanger") ~ "Other",
    endsWith(preferredPopularName, "rugde") ~ "Other",
    endsWith(preferredPopularName, "tundrasædgås") ~ "Other",
    endsWith(preferredPopularName, "fjellrype") ~ "Other",
    endsWith(preferredPopularName, "heilo") ~ "Other",
    endsWith(preferredPopularName, "kanadatrane") ~ "Other",
    endsWith(preferredPopularName, "blåstrupe") ~ "Other",
    endsWith(preferredPopularName, "sangsvane") ~ "Other",
    endsWith(preferredPopularName, "egretthegre") ~ "Other",
    endsWith(preferredPopularName, "fossekall") ~ "Other",
    endsWith(preferredPopularName, "svarthvit fluesnapper") ~ "Other",
    endsWith(preferredPopularName, "gulerle") ~ "Other",
    endsWith(preferredPopularName, "tyrkerdue") ~ "Other",
    endsWith(preferredPopularName, "taksvale") ~ "Other",
    endsWith(preferredPopularName, "polarsisik") ~ "Other",
    endsWith(preferredPopularName, "tretåspett") ~ "Other",
    endsWith(preferredPopularName, "lappspurv") ~ "Other",
    endsWith(preferredPopularName, "bokfink") ~ "Other",
    endsWith(preferredPopularName, "dompap") ~ "Other",
    endsWith(preferredPopularName, "myrhauk") ~ "Other",
    endsWith(preferredPopularName, "rødstrupe") ~ "Other",
    endsWith(preferredPopularName, "ringdue") ~ "Other",
    endsWith(preferredPopularName, "storlom") ~ "Other",
    endsWith(preferredPopularName, "måltrost") ~ "Other",
    endsWith(preferredPopularName, "jaktfalk") ~ "Other",
    endsWith(preferredPopularName, "bydue") ~ "Other",
    endsWith(preferredPopularName, "munk") ~ "Other",
    endsWith(preferredPopularName, "duetrost") ~ "Other",
    endsWith(preferredPopularName, "spurvehauk") ~ "Other",
    endsWith(preferredPopularName, "taigasædgås") ~ "Other",
    endsWith(preferredPopularName, "dverggås") ~ "Other",
    endsWith(preferredPopularName, "kaie") ~ "Other",
     endsWith(preferredPopularName, "trepiplerke") ~ "Other",
     endsWith(preferredPopularName, "buskskvett") ~ "Other",
     endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    endsWith(preferredPopularName, "islom") ~ "Other",
    endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    
        ))
    
View(dfFuglerSOM2)

table(dfFuglerSOM2$Bird)
```

Not
```{r pressure, echo=FALSE}
dfFuglerSOM3 <- read_excel("Bird_SOM3.xlsx", 
    col_types = c("text", "text", 
        "text", "text", "text", "text", "text", 
        "text"))

View(dfFuglerSOM3)
dfFuglerSOM3<-dfFuglerSOM3 %>% add_column(Site="SOM3")



dfFuglerSOM3<-dfFuglerSOM3 %>%  mutate(Bird = case_when(
          endsWith(preferredPopularName, "svartbak") ~"Gull",
    endsWith(preferredPopularName, "gråmåke") ~"Gull",
    endsWith(preferredPopularName, "polarmåke") ~"Gull",
    endsWith(preferredPopularName, "sildemåke") ~"Gull",
    endsWith(preferredPopularName, "krykkje") ~"Gull",
    endsWith(preferredPopularName, "fiskemåke")~"Gull",
    endsWith(preferredPopularName, "tyvjo")~"Gull",
    endsWith(preferredPopularName, "grønlandsmåke")~"Gull",
    endsWith(preferredPopularName, "hettemåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "ismåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "polarjo")~"Gull",
    endsWith(preferredPopularName, "fjelljo")~"Gull",
    
    endsWith(preferredPopularName, "fjæreplytt")~"Wader",
    endsWith(preferredPopularName, "tjeld")~"Wader",
    endsWith(preferredPopularName, "småspove")~"Wader",
    endsWith(preferredPopularName, "rødstilk")~"Wader",
    endsWith(preferredPopularName, "storspove")~"Wader",
    endsWith(preferredPopularName, "steinvender")~"Wader",
    endsWith(preferredPopularName, "sandlo")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "lappspove")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "sandløper")~"Wader",
    endsWith(preferredPopularName, "temmincksnipe")~"Wader",
    endsWith(preferredPopularName, "gluttsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "polarsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "dvergsnipe")~"Wader",
    endsWith(preferredPopularName, "svarthalespove")~"Wader",
    endsWith(preferredPopularName, "myrsnipe")~"Wader",
    endsWith(preferredPopularName, "skogsnipe")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",
    endsWith(preferredPopularName, "strandsnipe")~"Wader",
    endsWith(preferredPopularName, "tundralo")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",

    
    endsWith(preferredPopularName, "sjøorre") ~ "Duck",
    endsWith(preferredPopularName, "havelle") ~"Duck",
    endsWith(preferredPopularName, "svartand") ~"Duck",
    endsWith(preferredPopularName, "laksand") ~"Duck",
    endsWith(preferredPopularName, "siland")~"Duck",
    endsWith(preferredPopularName, "ærfugl") ~ "Duck",
    endsWith(preferredPopularName, "stokkand") ~ "Duck",
    endsWith(preferredPopularName, "gravand") ~ "Duck",
    endsWith(preferredPopularName, "brilleand") ~ "Duck",
    endsWith(preferredPopularName, "brunnakke") ~ "Duck",
    endsWith(preferredPopularName, "toppand") ~ "Duck",
    endsWith(preferredPopularName, "snadderand") ~ "Duck",
    endsWith(preferredPopularName, "stjertand") ~ "Duck",
    endsWith(preferredPopularName, "krikkand") ~ "Duck",
    endsWith(preferredPopularName, "knekkand") ~ "Duck",
    endsWith(preferredPopularName, "stellerand") ~ "Duck",

    
    endsWith(preferredPopularName, "snøspurv") ~ "Other",
    endsWith(preferredPopularName, "heipiplerke") ~ "Other",
    endsWith(preferredPopularName, "lomvi") ~ "Other",
    endsWith(preferredPopularName, "storskarv") ~ "Other",
    endsWith(preferredPopularName, "toppskarv") ~ "Other",
    endsWith(preferredPopularName, "fjellvåk") ~ "Other",
    endsWith(preferredPopularName, "gjøk") ~ "Other",
    endsWith(preferredPopularName, "havørn") ~ "Other",
    endsWith(preferredPopularName, "dvergfalk") ~ "Other",
    endsWith(preferredPopularName, "alke") ~ "Other",
    endsWith(preferredPopularName, "ravn") ~ "Other",
    endsWith(preferredPopularName, "lirype") ~ "Other",
    endsWith(preferredPopularName, "sidensvans") ~ "Other",
    endsWith(preferredPopularName, "lunde") ~ "Other",
    endsWith(preferredPopularName, "granmeis") ~ "Other",
    endsWith(preferredPopularName, "hvitkinngås") ~ "Other",
    endsWith(preferredPopularName, "tårnfalk") ~ "Other",
    endsWith(preferredPopularName, "gråhegre") ~ "Other",
    endsWith(preferredPopularName, "sivspurv") ~ "Other",
    endsWith(preferredPopularName, "kråke") ~ "Other",
    endsWith(preferredPopularName, "ringtrost") ~ "Other",
    endsWith(preferredPopularName, "teist") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "sandsvale") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "møller") ~ "Other",
    endsWith(preferredPopularName, "bergirisk") ~ "Other",
    endsWith(preferredPopularName, "rødnebbterne") ~ "Other",
    endsWith(preferredPopularName, "gjerdesmett") ~ "Other",
    endsWith(preferredPopularName, "alkekonge") ~ "Other",
    endsWith(preferredPopularName, "gråtrost") ~ "Other",
    endsWith(preferredPopularName, "stær") ~ "Other",
    endsWith(preferredPopularName, "havsvale") ~ "Other",
    endsWith(preferredPopularName, "jernspurv") ~ "Other",
    endsWith(preferredPopularName, "gråspurv") ~ "Other",
    endsWith(preferredPopularName, "sothøne") ~ "Other",
    endsWith(preferredPopularName, "gråspett") ~ "Other",
    endsWith(preferredPopularName, "bjørkefink") ~ "Other",
    endsWith(preferredPopularName, "steinskvett") ~ "Other",
    endsWith(preferredPopularName, "havsule") ~ "Other",
    endsWith(preferredPopularName, "gulspurv") ~ "Other",
    endsWith(preferredPopularName, "havhest") ~ "Other",
    endsWith(preferredPopularName, "gulnebblom") ~ "Other",
    endsWith(preferredPopularName, "vipe") ~ "Other",
    endsWith(preferredPopularName, "grågås") ~ "Other",
    endsWith(preferredPopularName, "jordugle") ~ "Other",
    endsWith(preferredPopularName, "smålom") ~ "Other",
    endsWith(preferredPopularName, "havlire") ~ "Other",
    endsWith(preferredPopularName, "kortnebbgås") ~ "Other",
    endsWith(preferredPopularName, "svarttrost") ~ "Other",
    endsWith(preferredPopularName, "hønsehauk") ~ "Other",
    endsWith(preferredPopularName, "løvsanger") ~ "Other",
    endsWith(preferredPopularName, "svartstrupe") ~ "Other",
    endsWith(preferredPopularName, "skjære") ~ "Other",
    endsWith(preferredPopularName, "stormsvale") ~ "Other",
    endsWith(preferredPopularName, "linerle") ~ "Other",
    endsWith(preferredPopularName, "grønnfink") ~ "Other",
    endsWith(preferredPopularName, "skjærpiplerke") ~ "Other",
    endsWith(preferredPopularName, "makrellterne") ~ "Other",
    endsWith(preferredPopularName, "tundragås") ~ "Other",
    endsWith(preferredPopularName, "orrfugl") ~ "Other",
    endsWith(preferredPopularName, "grålire") ~ "Other",
    endsWith(preferredPopularName, "låvesvale") ~ "Other",
    endsWith(preferredPopularName, "kjøttmeis") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "pilfink") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "sivsanger") ~ "Other",
    endsWith(preferredPopularName, "enkeltbekkasin") ~ "Other",
    endsWith(preferredPopularName, "rødvingetrost") ~ "Other",
    endsWith(preferredPopularName, "kongeørn") ~ "Other",
    endsWith(preferredPopularName, "myrsnipe") ~ "Other",
    endsWith(preferredPopularName, "gransanger") ~ "Other",
    endsWith(preferredPopularName, "rugde") ~ "Other",
    endsWith(preferredPopularName, "tundrasædgås") ~ "Other",
    endsWith(preferredPopularName, "fjellrype") ~ "Other",
    endsWith(preferredPopularName, "heilo") ~ "Other",
    endsWith(preferredPopularName, "kanadatrane") ~ "Other",
    endsWith(preferredPopularName, "blåstrupe") ~ "Other",
    endsWith(preferredPopularName, "sangsvane") ~ "Other",
    endsWith(preferredPopularName, "egretthegre") ~ "Other",
    endsWith(preferredPopularName, "fossekall") ~ "Other",
    endsWith(preferredPopularName, "svarthvit fluesnapper") ~ "Other",
    endsWith(preferredPopularName, "gulerle") ~ "Other",
    endsWith(preferredPopularName, "tyrkerdue") ~ "Other",
    endsWith(preferredPopularName, "taksvale") ~ "Other",
    endsWith(preferredPopularName, "polarsisik") ~ "Other",
    endsWith(preferredPopularName, "tretåspett") ~ "Other",
    endsWith(preferredPopularName, "lappspurv") ~ "Other",
    endsWith(preferredPopularName, "bokfink") ~ "Other",
    endsWith(preferredPopularName, "dompap") ~ "Other",
    endsWith(preferredPopularName, "myrhauk") ~ "Other",
    endsWith(preferredPopularName, "rødstrupe") ~ "Other",
    endsWith(preferredPopularName, "ringdue") ~ "Other",
    endsWith(preferredPopularName, "storlom") ~ "Other",
    endsWith(preferredPopularName, "måltrost") ~ "Other",
    endsWith(preferredPopularName, "jaktfalk") ~ "Other",
    endsWith(preferredPopularName, "bydue") ~ "Other",
    endsWith(preferredPopularName, "munk") ~ "Other",
    endsWith(preferredPopularName, "duetrost") ~ "Other",
    endsWith(preferredPopularName, "spurvehauk") ~ "Other",
    endsWith(preferredPopularName, "taigasædgås") ~ "Other",
    endsWith(preferredPopularName, "dverggås") ~ "Other",
    endsWith(preferredPopularName, "kaie") ~ "Other",
     endsWith(preferredPopularName, "trepiplerke") ~ "Other",
     endsWith(preferredPopularName, "buskskvett") ~ "Other",
     endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    endsWith(preferredPopularName, "islom") ~ "Other",
    endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    
        ))
View(dfFuglerSOM3)

table(dfFuglerSOM3$Bird)
```

```{r pressure, echo=FALSE}
dfFuglerSOM4<-read_excel("Bird_SOM4.xlsx", 
    col_types = c("text", "text", 
        "text", "text", "text", "text", "text", 
        "text"))

View(dfFuglerSOM4)
dfFuglerSOM4<-dfFuglerSOM4 %>% add_column(Site="SOM4")



dfFuglerSOM4<-dfFuglerSOM4 %>%  mutate(Bird = case_when(
       endsWith(preferredPopularName, "svartbak") ~"Gull",
    endsWith(preferredPopularName, "gråmåke") ~"Gull",
    endsWith(preferredPopularName, "polarmåke") ~"Gull",
    endsWith(preferredPopularName, "sildemåke") ~"Gull",
    endsWith(preferredPopularName, "krykkje") ~"Gull",
    endsWith(preferredPopularName, "fiskemåke")~"Gull",
    endsWith(preferredPopularName, "tyvjo")~"Gull",
    endsWith(preferredPopularName, "grønlandsmåke")~"Gull",
    endsWith(preferredPopularName, "hettemåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "ismåke")~"Gull",
    endsWith(preferredPopularName, "storjo")~"Gull",
    endsWith(preferredPopularName, "polarjo")~"Gull",
    endsWith(preferredPopularName, "fjelljo")~"Gull",
    
    endsWith(preferredPopularName, "fjæreplytt")~"Wader",
    endsWith(preferredPopularName, "tjeld")~"Wader",
    endsWith(preferredPopularName, "småspove")~"Wader",
    endsWith(preferredPopularName, "rødstilk")~"Wader",
    endsWith(preferredPopularName, "storspove")~"Wader",
    endsWith(preferredPopularName, "steinvender")~"Wader",
    endsWith(preferredPopularName, "sandlo")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "lappspove")~"Wader",
    endsWith(preferredPopularName, "sotsnipe")~"Wader",
    endsWith(preferredPopularName, "brushane")~"Wader",
    endsWith(preferredPopularName, "sandløper")~"Wader",
    endsWith(preferredPopularName, "temmincksnipe")~"Wader",
    endsWith(preferredPopularName, "gluttsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "polarsnipe")~"Wader",
    endsWith(preferredPopularName, "tundrasnipe")~"Wader",
    endsWith(preferredPopularName, "dvergsnipe")~"Wader",
    endsWith(preferredPopularName, "svarthalespove")~"Wader",
    endsWith(preferredPopularName, "myrsnipe")~"Wader",
    endsWith(preferredPopularName, "skogsnipe")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",
    endsWith(preferredPopularName, "strandsnipe")~"Wader",
    endsWith(preferredPopularName, "tundralo")~"Wader",
    endsWith(preferredPopularName, "grønnstilk")~"Wader",

    
    endsWith(preferredPopularName, "sjøorre") ~ "Duck",
    endsWith(preferredPopularName, "havelle") ~"Duck",
    endsWith(preferredPopularName, "svartand") ~"Duck",
    endsWith(preferredPopularName, "laksand") ~"Duck",
    endsWith(preferredPopularName, "siland")~"Duck",
    endsWith(preferredPopularName, "ærfugl") ~ "Duck",
    endsWith(preferredPopularName, "stokkand") ~ "Duck",
    endsWith(preferredPopularName, "gravand") ~ "Duck",
    endsWith(preferredPopularName, "brilleand") ~ "Duck",
    endsWith(preferredPopularName, "brunnakke") ~ "Duck",
    endsWith(preferredPopularName, "toppand") ~ "Duck",
    endsWith(preferredPopularName, "snadderand") ~ "Duck",
    endsWith(preferredPopularName, "stjertand") ~ "Duck",
    endsWith(preferredPopularName, "krikkand") ~ "Duck",
    endsWith(preferredPopularName, "knekkand") ~ "Duck",
    endsWith(preferredPopularName, "stellerand") ~ "Duck",

    
    endsWith(preferredPopularName, "snøspurv") ~ "Other",
    endsWith(preferredPopularName, "heipiplerke") ~ "Other",
    endsWith(preferredPopularName, "lomvi") ~ "Other",
    endsWith(preferredPopularName, "storskarv") ~ "Other",
    endsWith(preferredPopularName, "toppskarv") ~ "Other",
    endsWith(preferredPopularName, "fjellvåk") ~ "Other",
    endsWith(preferredPopularName, "gjøk") ~ "Other",
    endsWith(preferredPopularName, "havørn") ~ "Other",
    endsWith(preferredPopularName, "dvergfalk") ~ "Other",
    endsWith(preferredPopularName, "alke") ~ "Other",
    endsWith(preferredPopularName, "ravn") ~ "Other",
    endsWith(preferredPopularName, "lirype") ~ "Other",
    endsWith(preferredPopularName, "sidensvans") ~ "Other",
    endsWith(preferredPopularName, "lunde") ~ "Other",
    endsWith(preferredPopularName, "granmeis") ~ "Other",
    endsWith(preferredPopularName, "hvitkinngås") ~ "Other",
    endsWith(preferredPopularName, "tårnfalk") ~ "Other",
    endsWith(preferredPopularName, "gråhegre") ~ "Other",
    endsWith(preferredPopularName, "sivspurv") ~ "Other",
    endsWith(preferredPopularName, "kråke") ~ "Other",
    endsWith(preferredPopularName, "ringtrost") ~ "Other",
    endsWith(preferredPopularName, "teist") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "sandsvale") ~ "Other",
    endsWith(preferredPopularName, "gråsisik") ~ "Other",
    endsWith(preferredPopularName, "møller") ~ "Other",
    endsWith(preferredPopularName, "bergirisk") ~ "Other",
    endsWith(preferredPopularName, "rødnebbterne") ~ "Other",
    endsWith(preferredPopularName, "gjerdesmett") ~ "Other",
    endsWith(preferredPopularName, "alkekonge") ~ "Other",
    endsWith(preferredPopularName, "gråtrost") ~ "Other",
    endsWith(preferredPopularName, "stær") ~ "Other",
    endsWith(preferredPopularName, "havsvale") ~ "Other",
    endsWith(preferredPopularName, "jernspurv") ~ "Other",
    endsWith(preferredPopularName, "gråspurv") ~ "Other",
    endsWith(preferredPopularName, "sothøne") ~ "Other",
    endsWith(preferredPopularName, "gråspett") ~ "Other",
    endsWith(preferredPopularName, "bjørkefink") ~ "Other",
    endsWith(preferredPopularName, "steinskvett") ~ "Other",
    endsWith(preferredPopularName, "havsule") ~ "Other",
    endsWith(preferredPopularName, "gulspurv") ~ "Other",
    endsWith(preferredPopularName, "havhest") ~ "Other",
    endsWith(preferredPopularName, "gulnebblom") ~ "Other",
    endsWith(preferredPopularName, "vipe") ~ "Other",
    endsWith(preferredPopularName, "grågås") ~ "Other",
    endsWith(preferredPopularName, "jordugle") ~ "Other",
    endsWith(preferredPopularName, "smålom") ~ "Other",
    endsWith(preferredPopularName, "havlire") ~ "Other",
    endsWith(preferredPopularName, "kortnebbgås") ~ "Other",
    endsWith(preferredPopularName, "svarttrost") ~ "Other",
    endsWith(preferredPopularName, "hønsehauk") ~ "Other",
    endsWith(preferredPopularName, "løvsanger") ~ "Other",
    endsWith(preferredPopularName, "svartstrupe") ~ "Other",
    endsWith(preferredPopularName, "skjære") ~ "Other",
    endsWith(preferredPopularName, "stormsvale") ~ "Other",
    endsWith(preferredPopularName, "linerle") ~ "Other",
    endsWith(preferredPopularName, "grønnfink") ~ "Other",
    endsWith(preferredPopularName, "skjærpiplerke") ~ "Other",
    endsWith(preferredPopularName, "makrellterne") ~ "Other",
    endsWith(preferredPopularName, "tundragås") ~ "Other",
    endsWith(preferredPopularName, "orrfugl") ~ "Other",
    endsWith(preferredPopularName, "grålire") ~ "Other",
    endsWith(preferredPopularName, "låvesvale") ~ "Other",
    endsWith(preferredPopularName, "kjøttmeis") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "pilfink") ~ "Other",
    endsWith(preferredPopularName, "boltit") ~ "Other",
    endsWith(preferredPopularName, "sivsanger") ~ "Other",
    endsWith(preferredPopularName, "enkeltbekkasin") ~ "Other",
    endsWith(preferredPopularName, "rødvingetrost") ~ "Other",
    endsWith(preferredPopularName, "kongeørn") ~ "Other",
    endsWith(preferredPopularName, "myrsnipe") ~ "Other",
    endsWith(preferredPopularName, "gransanger") ~ "Other",
    endsWith(preferredPopularName, "rugde") ~ "Other",
    endsWith(preferredPopularName, "tundrasædgås") ~ "Other",
    endsWith(preferredPopularName, "fjellrype") ~ "Other",
    endsWith(preferredPopularName, "heilo") ~ "Other",
    endsWith(preferredPopularName, "kanadatrane") ~ "Other",
    endsWith(preferredPopularName, "blåstrupe") ~ "Other",
    endsWith(preferredPopularName, "sangsvane") ~ "Other",
    endsWith(preferredPopularName, "egretthegre") ~ "Other",
    endsWith(preferredPopularName, "fossekall") ~ "Other",
    endsWith(preferredPopularName, "svarthvit fluesnapper") ~ "Other",
    endsWith(preferredPopularName, "gulerle") ~ "Other",
    endsWith(preferredPopularName, "tyrkerdue") ~ "Other",
    endsWith(preferredPopularName, "taksvale") ~ "Other",
    endsWith(preferredPopularName, "polarsisik") ~ "Other",
    endsWith(preferredPopularName, "tretåspett") ~ "Other",
    endsWith(preferredPopularName, "lappspurv") ~ "Other",
    endsWith(preferredPopularName, "bokfink") ~ "Other",
    endsWith(preferredPopularName, "dompap") ~ "Other",
    endsWith(preferredPopularName, "myrhauk") ~ "Other",
    endsWith(preferredPopularName, "rødstrupe") ~ "Other",
    endsWith(preferredPopularName, "ringdue") ~ "Other",
    endsWith(preferredPopularName, "storlom") ~ "Other",
    endsWith(preferredPopularName, "måltrost") ~ "Other",
    endsWith(preferredPopularName, "jaktfalk") ~ "Other",
    endsWith(preferredPopularName, "bydue") ~ "Other",
    endsWith(preferredPopularName, "munk") ~ "Other",
    endsWith(preferredPopularName, "duetrost") ~ "Other",
    endsWith(preferredPopularName, "spurvehauk") ~ "Other",
    endsWith(preferredPopularName, "taigasædgås") ~ "Other",
    endsWith(preferredPopularName, "dverggås") ~ "Other",
    endsWith(preferredPopularName, "kaie") ~ "Other",
     endsWith(preferredPopularName, "trepiplerke") ~ "Other",
     endsWith(preferredPopularName, "buskskvett") ~ "Other",
     endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    endsWith(preferredPopularName, "islom") ~ "Other",
    endsWith(preferredPopularName, "grønnsisik") ~ "Other",
    
        ))
View(dfFuglerSOM4)

table(dfFuglerSOM4$Bird)
```

```{r}
#put all data frames into list
df_list <- list(dfFuglerSOM1, dfFuglerSOM2, dfFuglerSOM3, dfFuglerSOM4)      

#merge all data frames together
Bird_Data<-Reduce(function(x, y) merge(x, y, all=TRUE), df_list)  
View(Bird_Data)

ggplot(Bird_Data[(!is.na(Bird_Data$Site) & 
                        !is.na(Bird_Data$Bird)), ],
         aes(x = Site, fill = Bird)) +
  geom_bar(position = "dodge") +
  ggtitle("Bird functional Group per Site") +
  theme_bw()
  
ggplot(data = Bird_Data[(!is.na(Bird_Data$Site) & 
                        !is.na(Bird_Data$Bird)), ], 
       aes(x = Site, fill = Bird)) + 
  geom_bar(position = "fill") +
  theme_bw() +labs(x= "Site", y = "Fraction") +
  guides(fill = guide_legend(reverse = TRUE))+
  ggtitle("Bird functional Group per Site") +
  theme_bw()

#only relevant groups plotted  
relevant_groups<-subset(Bird_Data,Bird!="Other", Site!="<NA>" )

   ggplot(relevant_groups,aes(x = Site, fill = Bird)) +
  geom_bar(position = "dodge") +
  ggtitle("Bird functional Group per Site") +
  theme_bw()
  
ggplot(data = relevant_groups, aes(x = Site, fill = Bird)) + 
  scale_fill_manual(values = c("Wader" = "#c7ddad",
                               "Duck" = "#ea700b",
                               "Gull" = "#316787"),
                    labels = c("Duck" = "Ducks", 
                               "Gull" = "Gulls", 
                               "Wader" = "Waders")) +
  geom_bar(position = "fill") + theme_bw() + labs(x = "Location", y = "Percentage (%)", fill = "Avifauna") +
  guides(fill = guide_legend(override.aes = list(pattern = c("Wader" = "Waders", 
                                                             "Duck" = "Ducks", 
                                                             "Gull" = "Gulls")))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) + theme_bw()


tabyl(Bird_Data, Bird, Site)
dfFuglerSOM1 <- dfFuglerSOM1 %>% 
  mutate(x = hsize)

BirdTable<-table(relevant_groups$validScientificName,relevant_groups$Site, relevant_groups$Bird)
BirdTable
```